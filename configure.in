dnl configure.in for libstatgrab
dnl $Id$

dnl Change these to change the package name and version
AC_INIT(libstatgrab, 0.1, dev@i-scream.org.uk)
AM_INIT_AUTOMAKE(libstatgrab, 0.1)

dnl The file we use to pass #define's to the source
AM_CONFIG_HEADER(config.h)

dnl We need a CC, install, and ranlib
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_RANLIB

dnl And we probably need the standard C bits
AC_HEADER_STDC

dnl The program needs to know whether it can use getloadavg
AC_CHECK_FUNCS(getloadavg)

dnl Figure out details about the host - we need the OS
AC_CANONICAL_HOST

dnl Set things up for different OS's
dnl We define the name of the OS so the code can act accordingly
dnl We also need to add the right LDFLAGS
case $host_os in
solaris2.*)
	AC_DEFINE(SOLARIS, , [Building on Solaris 2.x])
	LDFLAGS="$LDFLAGS -lkstat"
	;;
freebsd4.*)
	AC_DEFINE(FREEBSD, , [Building on FreeBSD 4.x])
	LDFLAGS="$LDFLAGS -lkvm"
	;;
linux-gnu)
	AC_DEFINE(LINUX, , [Building on GNU/Linux])
	;;
*)
	AC_MSG_ERROR([Cannot build on unknown OS: $host_os])
	;;
esac

dnl And finish by changing these files
AC_OUTPUT([Makefile])
