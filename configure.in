#                                               -*- Autoconf -*-
# Process this file with autoconf to produce a configure script.
#
# configure.in for libstatgrab
# $Id$
#

# Change these to change the package name and version
AC_INIT(libstatgrab, 0.2, dev@i-scream.org.uk)
AM_INIT_AUTOMAKE(libstatgrab, 0.2)

# Revision number (automatically updated)
AC_REVISION($Revision$)

# Might work with older autoconfs... but tested on 2.57
AC_PREREQ(2.57)

# The file we use to pass #define's to the source
AM_CONFIG_HEADER([config.h])

# Checks for programs
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_LIBTOOL

# Checks for header files
AC_HEADER_STDC

# Checks for typedefs, structures, and compiler characteristics
AC_C_CONST

# Checks for library functions
AC_FUNC_MALLOC
AC_FUNC_REALLOC

# Set things up for different OS's
# We define the name of the OS so the code can act accordingly
# We also need to add the right LDFLAGS
case $host_os in
solaris2.*)
	AC_CHECK_HEADERS([kstat.h],,[AC_MSG_ERROR([need kstat.h])])
	AC_DEFINE(SOLARIS, , [Building on Solaris 2.x])
	LDFLAGS="$LDFLAGS -lkstat"
	;;
freebsd4.*)
	AC_DEFINE(FREEBSD, , [Building on FreeBSD 4.x])
	LDFLAGS="$LDFLAGS -lkvm"
	;;
linux-gnu)
	AC_DEFINE(LINUX, , [Building on GNU/Linux])
	;;
*)
	AC_MSG_ERROR([Cannot build on unknown OS: $host_os])
	;;
esac

# And finish by changing these files
AC_CONFIG_FILES([Makefile src/Makefile])

AC_OUTPUT
